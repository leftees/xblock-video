<div>
    <video data-video-id="{{ video_id }}"
        id="{{ video_player_id }}"
        data-account="{{ account_id }}"
        data-player="{{player_id}}"
        data-embed="default"
        data-application-id
        data-setup='{"playbackRates": [0.5, 1, 1.5, 2] }'
        width="100%"
        height="560"
        class="video-js"
        controls
    >
    <!-- height="560" it's height of iframe minus height of control bar -->
      {% for transcript in player_state.transcripts %}
        <track kind="captions" src="{{ transcript.url }}" srclang="{{ transcript.lang }}" label="{{ transcript.label }}"
        {% if forloop.first %}default{% endif %}>
      {% endfor %}
    </video>
    <script src="{{ brightcove_js_url }}"></script>
    <script src="https://cdn.rawgit.com/walsh9/videojs-transcript/master/dist/videojs-transcript.min.js"></script>
    <script>
        var player = videojs('{{ video_player_id }}');
        var Button = videojs.getComponent('Button');
        var ToggleButton = videojs.extend(Button, {
          constructor: function constructor(player, options) {
            Button.call(this, player, options);
            this.on('click', this.onClick);
            this.createEl();
          },
          styledSpan: function styledSpan() {
            return this.options()['style'];
          },
          enabledEventName: function enabledEventName() {
            return this.options()['enabledEvent'];
          },
          disabledEventName: function disabledEventName() {
            return this.options()['disabledEvent'];
          },
          buildCSSClass: function buildCSSClass() {
            return this.options()['cssClasses'];
          },
          createEl: function createEl(props, attributes) {
            props = props || {};
            props['className'] = this.buildCSSClass();
            props['innerHTML'] = '<div class="vjs-control-content ' + this.styledSpan() + '"></div>';
            props['tabIndex'] = 0;
            props['role'] = 'button';
            props['aria-live'] = 'polite';
            return Button.prototype.createEl.call(this, arguments.tag, props, attributes);
          },
          onClick: function onClick(event) {
            var el = event.currentTarget;
            el.classList.toggle('vjs-control-enabled');
            this.trigger(this.hasClass(el, 'vjs-control-enabled') ? this.enabledEventName() : this.disabledEventName());
          },
        });

        var toggleButton = function(options){
          this.controlBar.addChild('ToggleButton', options);
        };

        videojs.registerComponent('ToggleButton', ToggleButton);
        videojs.plugin('toggleButton', toggleButton);

        videojs.plugin('xblockEventPlugin', window.xblockEventPlugin);
        player.xblockEventPlugin();
        videojs.plugin('offset', window.vjsoffset);

        player.offset({
            "start": {{ start_time }}, // do not use quotes for this properties for correct plugin work
            "end": {{ end_time }}
        });
    </script>
</div>
<div id="transcript"></div>
